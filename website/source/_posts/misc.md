---
title: misc
date: 2017-01-11 21:07:11
tags: [rbzhou]
---

#福建网站反应迟缓复盘
福建的版本一直都非常危险,各种adhoc，并且问题频出。这里面有历史的形成，也有网站设计上的问题。现在准备复盘并整理一下。

##背景

版本是1.6.4, 从1.5.x的版本升级上来。1.6.4也不是正式发布的版本，并且中途加了一些升级的adhoc修改。后台的服务器规模不在我们的scope内，但需要考虑网站会与一些其他的应用公用一个后台。

##现象

- 访问网站时，显示不出内容。
- 偶尔可以出现页面，加载时间都在20s以上，且经常不能正常跳转。
- 白天非常卡顿，不能使用，晚上很流畅。

## 原因定位

整个网站的流程访问流程如下:
```
chrome -> nginx -> (java后台，即tomcat) -> 大平台
```
排查过程从浏览器端开始。

F12看`Network`标签页，发现大量请求处于pending状态，静态资源(js文件/png文件)也是pending状态。但一开始并没有检查pending的具体原因，而是惯性思维的认为是后台的global接口返回时间长，在等待其返回。后台通过接口调用，2s返回，说明瓶颈不在后台。

于是进一步确定pending的时间在到底在等什么。点开左侧




